services:
    symfonian_id.admin.annotation:
        class: Symfonian\Indonesia\AdminBundle\Annotation\Reader\AnnotationReader
        arguments:
            - '@annotation_reader'
            - '@symfonian_id.admin.handler.configuration'
            - '@symfonian_id.admin.handler.upload'
        tags:
            - { name: kernel.event_listener, event: kernel.controller, method: onKernelController, priority: -255 }

    symfonian_id.admin.delete_user:
        class: Symfonian\Indonesia\AdminBundle\EventListener\DeleteUserListener
        arguments:
            - '@security.token_storage'
            - '@translator'
            - '%symfonian_id.admin.translation_domain%'
        tags:
            - { name: kernel.event_listener, event: siab.pre_delete, method: onDeleteUser }

    symfonian_id.admin.set_timestamp:
        class: Symfonian\Indonesia\AdminBundle\EventListener\SetTimestampListener
        arguments:
            - '@security.token_storage'
        tags:
            - { name: kernel.event_listener, event: siab.pre_save, method: onPreSaveUser }

    symfonian_id.admin.update_user:
        class: Symfonian\Indonesia\AdminBundle\EventListener\UpdateUserListener
        arguments:
            - '%symfonian_id.admin.security.auto_enable%'
        tags:
            - { name: kernel.event_listener, event: siab.pre_save, method: onPreSaveUser }

    symfonian_id.admin.upload:
        class: Symfonian\Indonesia\AdminBundle\EventListener\UploadAvatarListener
        arguments:
            - '@symfonian_id.admin.handler.upload'
            - '%symfonian_id.admin.upload_dir%'
        tags:
            - { name: kernel.event_listener, event: siab.pre_save, method: onPreSave }

    symfonian_id.admin.remove_password_field:
        class: Symfonian\Indonesia\AdminBundle\EventListener\RemovePasswordFieldListener
        tags:
            - { name: kernel.event_listener, event: siab.pre_form_submit, method: onPreCreateForm }

    symfonian_id.admin.default_template_compiler:
        class: Symfonian\Indonesia\AdminBundle\Compiler\DefaultTemplateCompiler
        arguments:
            - '@service_container'
        tags:
            - { name: kernel.event_listener, event: kernel.controller, method: onKernelController, priority: 255 }

    symfonian_id.admin.user_controller_compiler:
        class: Symfonian\Indonesia\AdminBundle\Compiler\UserControllerCompiler
        arguments:
            - '@service_container'
        tags:
            - { name: kernel.event_listener, event: kernel.controller, method: onKernelController, priority: 0 }

    symfonian_id.admin.profile_controller_compiler:
        class: Symfonian\Indonesia\AdminBundle\Compiler\ProfileControllerCompiler
        arguments:
            - '@service_container'
        tags:
            - { name: kernel.event_listener, event: kernel.controller, method: onKernelController, priority: 0 }

    symfonian_id.admin.twig_global_variable_compiler:
        class: Symfonian\Indonesia\AdminBundle\Twig\GlobalVariableRegistrator
        calls:
            - [setVariables, {title: '%symfonian_id.admin.app_title%', short_title: '%symfonian_id.admin.app_short_title%', date_format: '%symfonian_id.admin.date_time_format%', menu: '%symfonian_id.admin.menu%'}]
        arguments:
            - '@twig'
        tags:
            - { name: kernel.event_listener, event: kernel.request, method: onKernelRequest }

    symfonian_id.admin.menu:
        class: Symfonian\Indonesia\AdminBundle\Menu\Builder
        arguments:
            - '@router'
            - '@translator'
            - '@security.authorization_checker'
            - '%symfonian_id.admin.translation_domain%'

    symfonian_id.admin.main_menu:
        class: Knp\Menu\MenuItem
        factory_service: symfonian_id.admin.menu
        factory_method: mainMenu
        arguments:
            - '@knp_menu.factory'
            - []
        tags:
            - { name: knp_menu.menu, alias: symfonian_indonesia_admin_main_menu }

    symfonian_id.admin.change_password_form:
        class: Symfonian\Indonesia\AdminBundle\Form\ChangePasswordType
        arguments:
            - '%symfonian_id.admin.security.user_entity%'
            - '%symfonian_id.admin.translation_domain%'
        tags:
            - { name: form.type }

    symfonian_id.admin.user_form:
        class: Symfonian\Indonesia\AdminBundle\Form\UserType
        arguments:
            - '%symfonian_id.admin.security.user_entity%'
            - '%symfonian_id.admin.translation_domain%'
            - '%security.role_hierarchy.roles%'
            - '%symfonian_id.admin.upload_dir%'
        tags:
            - { name: form.type }

    symfonian_id.admin.home_route_loader:
        class: Symfonian\Indonesia\AdminBundle\Route\HomeRouteLoader
        arguments:
            - '%symfonian_id.admin.home.route_path%'
            - '%symfonian_id.admin.home.controller%'
        tags:
            - { name: routing.loader }

    symfonian_id.admin.twig.is_number:
        class: Symfonian\Indonesia\AdminBundle\Twig\Comparations\NumberTest
        tags:
            - { name: twig.extension }

    symfonian_id.admin.twig.is_boolean:
        class: Symfonian\Indonesia\AdminBundle\Twig\Comparations\BooleanTest
        tags:
            - { name: twig.extension }

    symfonian_id.admin.twig.ucwords:
        class: Symfonian\Indonesia\AdminBundle\Twig\Filters\UcWordsFilter
        tags:
            - { name: twig.extension }

    symfonian_id.admin.twig.generate_avatar:
        class: Symfonian\Indonesia\AdminBundle\Twig\Functions\GenerateUserAvatarFunction
        arguments:
            - '%symfonian_id.admin.upload_dir%'
        tags:
            - { name: twig.extension }

    symfonian_id.admin.handler.crud:
        class: Symfonian\Indonesia\AdminBundle\Handler\CrudHandler
        arguments:
            - '@service_container'

    symfonian_id.admin.handler.configuration:
        class: Symfonian\Indonesia\AdminBundle\Handler\ConfigurationHandler
        calls:
            - [setContainer, ['@service_container']]
        arguments:
            - '@form.factory'
            - '%symfonian_id.admin.translation_domain%'

    symfonian_id.admin.handler.upload:
        class: Symfonian\Indonesia\AdminBundle\Handler\UploadHandler