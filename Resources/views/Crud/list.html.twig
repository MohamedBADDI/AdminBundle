{% spaceless %}
    <script type="text/javascript">
        jQuery(document).ready(function() {
            jQuery(document).on('click', '.sfid-pagination a.btn-success', function (e) {
                e.preventDefault();

                var url = jQuery(this).attr('href');

                jQuery.ajax({
                    url: url,
                    type:'GET',
                    dataType: 'html'
                }).done (function (response) {
                    jQuery('.sfid-content').html(response);
                    jQuery('.sfid-toggle').bootstrapToggle();
                });
            });

            jQuery(document).on('click', '.header-sortable', function (e) {
                getUrlVars(function (queryString) {
                    queryString['sort_by'] = jQuery(this).data('field');

                    var url = document.location.pathname;
                    if (!0 < url.indexOf('?')) {
                        url = url + '?';
                    }

                    encodeUrl(url , queryString, function (encodedUrl) {
                        window.location = encodedUrl;
                    });
                });
            });

            jQuery('.sortable').addClass('fa-sort');
            jQuery('.sorted').addClass('fa-sort-asc');
            jQuery('.header-sortable').css('cursor', 'pointer');
            jQuery('.siab-search').val(getQueryString('filter'));
        });

        function getUrlVars(callback) {
            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');

            for(var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars[hash[0]] = hash[1];
            }

            callback(vars);
        };

        function encodeUrl(url , data, callback) {
            var ret = [];
            jQuery.each(data, function(key, value) {
                if ('undefined' !== typeof data[value]) {
                    ret.push(encodeURIComponent(value) + '=' + encodeURIComponent(data[value]));
                }
            });

            callback(url + ret.join('&'));
        };

        function getQueryString(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"), results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        };
    </script>
{% endspaceless %}